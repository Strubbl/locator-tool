import{d as ee,j as i,k as te,l as O,b as U,c as b,u as l,f as a,m as k,a as e,e as r,n as T,p as u,v as B,q as f,s as A,F as P,r as W,x as H,y as se,z as le,o as d,t as n,A as oe,B as ne,i as j,C as N,D as R}from"./index-C0KEJt2O.js";import{g as ae,a as ie}from"./DadgABpvQcQp3i1OjiC.js";import{l as J}from"./DZQLFrWwtX9iwzB4cFH.js";const re={key:0,class:"mt-4"},ue={key:1},de=["href"],ce={key:2,class:"mt-4"},me={class:"nav nav-pills my-3"},pe={class:"nav-item"},ve={class:"nav-item"},be={class:"nav-item"},ge={class:"mb-4"},ye={for:"inputUser"},fe={class:"row"},he={class:"mb-4 col-sm-4"},_e={for:"inputUserLimit","translate-comment":"maximum number of files"},Ce={class:"mb-4 col-sm-4"},Ue={for:"inputUserStart"},ke={class:"mb-4 col-sm-4"},$e={for:"inputUserEnd"},Le={class:"mb-4"},Se=["disabled"],we=["disabled"],xe=["disabled"],De=["disabled"],Fe={id:"datalistUser"},qe=["value"],Ve={class:"row"},Ee={class:"mb-4 col-lg-10"},Ie={for:"inputCategory"},Me={class:"mb-4 col-lg-2"},Te={for:"inputCategoryDepth","translate-comment":"Depth of category tree","translate-context":"Category"},Be={class:"mb-4"},Pe=["disabled"],He=["disabled"],je=["disabled"],Ne=["disabled"],Re={id:"datalistCategory"},ze=["value"],Ge={class:"mb-4"},Oe={for:"inputTitles"},Ae=["innerHTML"],We={class:"mb-4"},Je=["disabled"],Ke=["disabled"],Qe=["disabled"],tt=ee({__name:"ltFilesSelector",setup(Xe){const g=se(),x=le(),h=i(!1),c=i(g.query.user?2:1),m=i(g.query.category),D=i(G(parseInt,g.query.categoryDepth,3)),z=i([]),p=i(g.query.user),F=i(G(parseInt,g.query.userLimit,void 0)),q=i(g.query.userStart),V=i(g.query.userEnd),E=i([]),$=i("");function G(o,t,C){if(!t)return C;try{return o(t)}catch{return C}}const{data:L}=te();O(m,async o=>{h.value=!0;try{z.value=await ae(o)}finally{h.value=!1}},{debounce:500}),O(p,async o=>{h.value=!0;try{E.value=await ie(o),console.log(E.value)}finally{h.value=!1}},{debounce:500});function I(o="geolocate"){const t=v.value.join("|");x.push({name:o,query:{files:t}})}function M(o="geolocate"){x.push({name:o,query:{user:p.value,userLimit:F.value,userStart:q.value,userEnd:V.value}})}function _(o="geolocate"){x.push({name:o,query:{category:m.value,categoryDepth:D.value}})}const v=U({get:()=>$.value.split(`
`).map(o=>o==null?void 0:o.split("|")[0]).filter(o=>o),set:o=>$.value=o==null?void 0:o.join(`
`)});function K(o){try{if(!o.clipboardData)return;const t=o.clipboardData.getData("text/html");if(!t||!/<a/.test(t))return;const w=new DOMParser().parseFromString(t,"text/html").getElementsByTagName("a"),s={};[...w].map(y=>decodeURI(y.href)).filter(y=>!!y).map(y=>y.replace(/.*File:/,"File:")).forEach(y=>s[y]=!0),v.value=Object.keys(s),o.preventDefault()}catch(t){console.warn("Could not parse HTML clipboard content",t)}}const Q=U(()=>{var o;return n("Hello {{$ctrl.userInfo}}!").replace("{{$ctrl.userInfo}}",(o=L.value)==null?void 0:o.user)}),X=U(()=>n("Load {{$ctrl.titleList.length}} files to geolocate").replace("{{$ctrl.titleList.length}}",v.value.length)),Y=U(()=>n("Show {{$ctrl.titleList.length}} files on map").replace("{{$ctrl.titleList.length}}",v.value.length)),Z=U(()=>n("Show {{$ctrl.titleList.length}} files as gallery").replace("{{$ctrl.titleList.length}}",v.value.length));return(o,t)=>{var C,S,w;return d(),b(P,null,[(C=l(L))!=null&&C.user?k("",!0):(d(),b("h2",re,a(l(n)("Sign in")),1)),(S=l(L))!=null&&S.user?k("",!0):(d(),b("p",ue,[e("span",null,a(l(n)("In order to allow locator-tool to modify file description pages, sign in first:")),1),e("a",{class:"btn btn-success ms-2",href:l(ne)()},[r(l(oe),{class:"me-1"}),e("span",null,a(l(n)("Log in")),1)],8,de)])),(w=l(L))!=null&&w.user?(d(),b("p",ce,a(Q.value),1)):k("",!0),e("h2",null,a(l(n)("Select files to geolocate")),1),e("ul",me,[e("li",pe,[e("button",{class:T(["nav-link",{active:c.value===1}]),onClick:t[0]||(t[0]=s=>c.value=1)},a(l(n)("Category")),3)]),e("li",ve,[e("button",{class:T(["nav-link",{active:c.value===2}]),onClick:t[1]||(t[1]=s=>c.value=2)},a(l(n)("User files")),3)]),e("li",be,[e("button",{class:T(["nav-link",{active:c.value===3}]),onClick:t[2]||(t[2]=s=>c.value=3)},a(l(n)("File list")),3)])]),u(e("form",{onSubmit:t[10]||(t[10]=H(s=>_(),["stop","prevent"]))},[e("div",ge,[e("label",ye,a(l(n)("User")),1),u(e("input",{id:"inputUser","onUpdate:modelValue":t[3]||(t[3]=s=>p.value=s),class:"form-control",list:"datalistUser",placeholder:"User:…"},null,512),[[f,p.value]])]),e("div",fe,[e("div",he,[e("label",_e,a(l(n)("Limit")),1),u(e("input",{id:"inputUserLimit","onUpdate:modelValue":t[4]||(t[4]=s=>F.value=s),class:"form-control",type:"number"},null,512),[[f,F.value]])]),e("div",Ce,[e("label",Ue,a(l(n)("Start timestamp")),1),u(e("input",{id:"inputUserStart","onUpdate:modelValue":t[5]||(t[5]=s=>q.value=s),class:"form-control",type:"date"},null,512),[[f,q.value]])]),e("div",ke,[e("label",$e,a(l(n)("End timestamp")),1),u(e("input",{id:"inputUserEnd","onUpdate:modelValue":t[6]||(t[6]=s=>V.value=s),class:"form-control",type:"date"},null,512),[[f,V.value]])])]),e("div",Le,[e("button",{class:"btn btn-success me-2",disabled:!p.value,onClick:t[7]||(t[7]=s=>M())},[r(l(j),{class:"me-1"}),e("span",null,a(l(n)("Load User files to geolocate")),1)],8,Se),e("button",{class:"btn btn-secondary me-2",disabled:!p.value,onClick:t[8]||(t[8]=s=>M("map"))},[r(l(N),{class:"me-1"}),e("span",null,a(l(n)("Show User files on map")),1)],8,we),e("button",{class:"btn btn-secondary me-2",disabled:!p.value,onClick:t[9]||(t[9]=s=>M("gallery"))},[r(l(R),{class:"me-1"}),e("span",null,a(l(n)("Show User files as gallery")),1)],8,xe),e("input",{class:"invisible",type:"submit",disabled:!p.value},null,8,De),h.value?(d(),A(J,{key:0})):k("",!0),e("datalist",Fe,[(d(!0),b(P,null,W(E.value,s=>(d(),b("option",{key:s,value:s},null,8,qe))),128))])])],544),[[B,c.value===2]]),u(e("form",{onSubmit:t[16]||(t[16]=H(s=>_(),["stop","prevent"]))},[e("div",Ve,[e("div",Ee,[e("label",Ie,a(l(n)("Category")),1),u(e("input",{id:"inputCategory","onUpdate:modelValue":t[11]||(t[11]=s=>m.value=s),class:"form-control",list:"datalistCategory",placeholder:"Category:…"},null,512),[[f,m.value]])]),e("div",Me,[e("label",Te,a(l(n)("Depth")),1),u(e("input",{id:"inputCategoryDepth","onUpdate:modelValue":t[12]||(t[12]=s=>D.value=s),class:"form-control",type:"number"},null,512),[[f,D.value]])])]),e("div",Be,[e("button",{class:"btn btn-success me-2",disabled:!m.value,onClick:t[13]||(t[13]=s=>_())},[r(l(j),{class:"me-1"}),e("span",null,a(l(n)("Load Category to geolocate")),1)],8,Pe),e("button",{class:"btn btn-secondary me-2",disabled:!m.value,onClick:t[14]||(t[14]=s=>_("map"))},[r(l(N),{class:"me-1"}),e("span",null,a(l(n)("Show Category on map")),1)],8,He),e("button",{class:"btn btn-secondary me-2",disabled:!m.value,onClick:t[15]||(t[15]=s=>_("gallery"))},[r(l(R),{class:"me-1"}),e("span",null,a(l(n)("Show Category as gallery")),1)],8,je),e("input",{class:"invisible",type:"submit",disabled:!m.value},null,8,Ne)]),h.value?(d(),A(J,{key:0})):k("",!0),e("datalist",Re,[(d(!0),b(P,null,W(z.value,s=>(d(),b("option",{key:s,value:s},null,8,ze))),128))])],544),[[B,c.value===1]]),u(e("form",{onSubmit:t[22]||(t[22]=H(s=>_(),["stop","prevent"]))},[e("div",Ge,[e("label",Oe,a(l(n)("File list")),1),u(e("textarea",{id:"inputTitles","onUpdate:modelValue":t[17]||(t[17]=s=>$.value=s),class:"form-control",rows:"10",placeholder:"File:…",onPaste:t[18]||(t[18]=s=>K(s))},null,544),[[f,$.value]]),e("p",{class:"form-text",innerHTML:l(n)("When a clipboard content containing HTML code (for instance a copied selection from a Commons gallery) is pasted here, locator-tool tries to extract <code>File:</code>s from the code.")},null,8,Ae)]),e("div",We,[e("button",{class:"btn btn-success me-2",disabled:!v.value.length,onClick:t[19]||(t[19]=s=>I())},[r(l(j),{class:"me-1"}),e("span",null,a(X.value),1)],8,Je),e("button",{class:"btn btn-secondary me-2",disabled:!v.value.length,onClick:t[20]||(t[20]=s=>I("map"))},[r(l(N),{class:"me-1"}),e("span",null,a(Y.value),1)],8,Ke),e("button",{class:"btn btn-secondary me-2",disabled:!v.value.length,onClick:t[21]||(t[21]=s=>I("gallery"))},[r(l(R),{class:"me-1"}),e("span",null,a(Z.value),1)],8,Qe)])],544),[[B,c.value===3]])],64)}}});export{tt as default};
//# sourceMappingURL=DJRWpXmhNjK_jn0R7WT.js.map
