var Oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function G(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var J=function(a){return Y(a)&&!B(a)};function Y(e){return!!e&&typeof e=="object"}function B(e){var a=Object.prototype.toString.call(e);return a==="[object RegExp]"||a==="[object Date]"||z(e)}var K=typeof Symbol=="function"&&Symbol.for,V=K?Symbol.for("react.element"):60103;function z(e){return e.$$typeof===V}function H(e){return Array.isArray(e)?[]:{}}function M(e,a){return a.clone!==!1&&a.isMergeableObject(e)?P(H(e),e,a):e}function Q(e,a,o){return e.concat(a).map(function(u){return M(u,o)})}function X(e,a){if(!a.customMerge)return P;var o=a.customMerge(e);return typeof o=="function"?o:P}function Z(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(a){return e.propertyIsEnumerable(a)}):[]}function $(e){return Object.keys(e).concat(Z(e))}function _(e,a){try{return a in e}catch{return!1}}function ee(e,a){return _(e,a)&&!(Object.hasOwnProperty.call(e,a)&&Object.propertyIsEnumerable.call(e,a))}function te(e,a,o){var u={};return o.isMergeableObject(e)&&$(e).forEach(function(l){u[l]=M(e[l],o)}),$(a).forEach(function(l){ee(e,l)||(_(e,l)&&o.isMergeableObject(a[l])?u[l]=X(l,o)(e[l],a[l],o):u[l]=M(a[l],o))}),u}function P(e,a,o){o=o||{},o.arrayMerge=o.arrayMerge||Q,o.isMergeableObject=o.isMergeableObject||J,o.cloneUnlessOtherwiseSpecified=M;var u=Array.isArray(a),l=Array.isArray(e),g=u===l;return g?u?o.arrayMerge(e,a,o):te(e,a,o):M(a,o)}P.all=function(a,o){if(!Array.isArray(a))throw new Error("first argument should be an array");return a.reduce(function(u,l){return P(u,l,o)},{})};var re=P,ne=re;const ae=G(ne);var q,D,oe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ie=(q=function(e){(function(a){function o(r,f){var t=(65535&r)+(65535&f);return(r>>16)+(f>>16)+(t>>16)<<16|65535&t}function u(r,f,t,m,h,b){return o((y=o(o(f,r),o(m,b)))<<(n=h)|y>>>32-n,t);var y,n}function l(r,f,t,m,h,b,y){return u(f&t|~f&m,r,f,h,b,y)}function g(r,f,t,m,h,b,y){return u(f&m|t&~m,r,f,h,b,y)}function d(r,f,t,m,h,b,y){return u(f^t^m,r,f,h,b,y)}function p(r,f,t,m,h,b,y){return u(t^(f|~m),r,f,h,b,y)}function O(r,f){var t,m,h,b,y;r[f>>5]|=128<<f%32,r[14+(f+64>>>9<<4)]=f;var n=1732584193,i=-271733879,c=-1732584194,s=271733878;for(t=0;t<r.length;t+=16)m=n,h=i,b=c,y=s,n=l(n,i,c,s,r[t],7,-680876936),s=l(s,n,i,c,r[t+1],12,-389564586),c=l(c,s,n,i,r[t+2],17,606105819),i=l(i,c,s,n,r[t+3],22,-1044525330),n=l(n,i,c,s,r[t+4],7,-176418897),s=l(s,n,i,c,r[t+5],12,1200080426),c=l(c,s,n,i,r[t+6],17,-1473231341),i=l(i,c,s,n,r[t+7],22,-45705983),n=l(n,i,c,s,r[t+8],7,1770035416),s=l(s,n,i,c,r[t+9],12,-1958414417),c=l(c,s,n,i,r[t+10],17,-42063),i=l(i,c,s,n,r[t+11],22,-1990404162),n=l(n,i,c,s,r[t+12],7,1804603682),s=l(s,n,i,c,r[t+13],12,-40341101),c=l(c,s,n,i,r[t+14],17,-1502002290),n=g(n,i=l(i,c,s,n,r[t+15],22,1236535329),c,s,r[t+1],5,-165796510),s=g(s,n,i,c,r[t+6],9,-1069501632),c=g(c,s,n,i,r[t+11],14,643717713),i=g(i,c,s,n,r[t],20,-373897302),n=g(n,i,c,s,r[t+5],5,-701558691),s=g(s,n,i,c,r[t+10],9,38016083),c=g(c,s,n,i,r[t+15],14,-660478335),i=g(i,c,s,n,r[t+4],20,-405537848),n=g(n,i,c,s,r[t+9],5,568446438),s=g(s,n,i,c,r[t+14],9,-1019803690),c=g(c,s,n,i,r[t+3],14,-187363961),i=g(i,c,s,n,r[t+8],20,1163531501),n=g(n,i,c,s,r[t+13],5,-1444681467),s=g(s,n,i,c,r[t+2],9,-51403784),c=g(c,s,n,i,r[t+7],14,1735328473),n=d(n,i=g(i,c,s,n,r[t+12],20,-1926607734),c,s,r[t+5],4,-378558),s=d(s,n,i,c,r[t+8],11,-2022574463),c=d(c,s,n,i,r[t+11],16,1839030562),i=d(i,c,s,n,r[t+14],23,-35309556),n=d(n,i,c,s,r[t+1],4,-1530992060),s=d(s,n,i,c,r[t+4],11,1272893353),c=d(c,s,n,i,r[t+7],16,-155497632),i=d(i,c,s,n,r[t+10],23,-1094730640),n=d(n,i,c,s,r[t+13],4,681279174),s=d(s,n,i,c,r[t],11,-358537222),c=d(c,s,n,i,r[t+3],16,-722521979),i=d(i,c,s,n,r[t+6],23,76029189),n=d(n,i,c,s,r[t+9],4,-640364487),s=d(s,n,i,c,r[t+12],11,-421815835),c=d(c,s,n,i,r[t+15],16,530742520),n=p(n,i=d(i,c,s,n,r[t+2],23,-995338651),c,s,r[t],6,-198630844),s=p(s,n,i,c,r[t+7],10,1126891415),c=p(c,s,n,i,r[t+14],15,-1416354905),i=p(i,c,s,n,r[t+5],21,-57434055),n=p(n,i,c,s,r[t+12],6,1700485571),s=p(s,n,i,c,r[t+3],10,-1894986606),c=p(c,s,n,i,r[t+10],15,-1051523),i=p(i,c,s,n,r[t+1],21,-2054922799),n=p(n,i,c,s,r[t+8],6,1873313359),s=p(s,n,i,c,r[t+15],10,-30611744),c=p(c,s,n,i,r[t+6],15,-1560198380),i=p(i,c,s,n,r[t+13],21,1309151649),n=p(n,i,c,s,r[t+4],6,-145523070),s=p(s,n,i,c,r[t+11],10,-1120210379),c=p(c,s,n,i,r[t+2],15,718787259),i=p(i,c,s,n,r[t+9],21,-343485551),n=o(n,m),i=o(i,h),c=o(c,b),s=o(s,y);return[n,i,c,s]}function w(r){var f,t="",m=32*r.length;for(f=0;f<m;f+=8)t+=String.fromCharCode(r[f>>5]>>>f%32&255);return t}function j(r){var f,t=[];for(t[(r.length>>2)-1]=void 0,f=0;f<t.length;f+=1)t[f]=0;var m=8*r.length;for(f=0;f<m;f+=8)t[f>>5]|=(255&r.charCodeAt(f/8))<<f%32;return t}function A(r){var f,t,m="0123456789abcdef",h="";for(t=0;t<r.length;t+=1)f=r.charCodeAt(t),h+=m.charAt(f>>>4&15)+m.charAt(15&f);return h}function C(r){return unescape(encodeURIComponent(r))}function S(r){return function(f){return w(O(j(f),8*f.length))}(C(r))}function E(r,f){return function(t,m){var h,b,y=j(t),n=[],i=[];for(n[15]=i[15]=void 0,y.length>16&&(y=O(y,8*t.length)),h=0;h<16;h+=1)n[h]=909522486^y[h],i[h]=1549556828^y[h];return b=O(n.concat(j(m)),512+8*m.length),w(O(i.concat(b),640))}(C(r),C(f))}function I(r,f,t){return f?t?E(f,r):A(E(f,r)):t?S(r):A(S(r))}e.exports?e.exports=I:a.md5=I})(oe)},q(D={exports:{}}),D.exports);function ce(e,a){e=e.replace(/^File:/,"").replace(/\s+/g,"_");var o=encodeURIComponent(e),u="https://upload.wikimedia.org/wikipedia/commons",l=ie(e),g=l[0]+"/"+l[0]+l[1];return a?u+"/thumb/"+g+"/"+o+"/"+a+"px-"+o+(e.match(/tiff?$/i)?".jpg":e.match(/svg$/i)?".png":""):u+"/"+g+"/"+o}class v{constructor(a,o,u,l,g){this.type=a,this.lat=o,this.lng=u,this.latOriginal=l,this.lngOriginal=g,arguments.length===3&&(this.latOriginal=o,this.lngOriginal=u)}withLatLng(a,o){return new v(this.type,a,o,this.latOriginal,this.lngOriginal)}roundToPrecision(){return new v(this.type,N(this.lat),N(this.lng),this.latOriginal,this.lngOriginal)}rollback(){return new v(this.type,this.latOriginal,this.lngOriginal)}commit(){return new v(this.type,this.lat,this.lng,this.lat,this.lng)}get isDefined(){return this.lat!==void 0&&this.lng!==void 0}get isChanged(){return this.lat!==this.latOriginal||this.lng!==this.lngOriginal}get isDefinedAndSaved(){return this.isDefined&&!this.isChanged}get csv(){return this.lat!==void 0&&this.lng!==void 0?[this.lat,this.lng].map(se).join(", "):""}}function se(e){return e%1===0?e.toFixed(1):e}function N(e,a=5){return typeof e=="number"?+e.toFixed(a):e}const k={"*":"P625",Location:"P1259","Object location":"P9149"},le="https://commons.wikimedia.org/w/api.php",x=6,ue=14,W=50;async function fe(e){var g;if(typeof e=="string"&&(e=e.split("|")),e.length>W)return ge(e);const a={prop:"coordinates",colimit:500,coprop:"type|name",coprimary:"all",titles:e.join("|").replace(/_/g," ")},o=await F(a),u=((g=o==null?void 0:o.query)==null?void 0:g.pages)||{};return Object.entries(u).map(([d,p])=>{var O,w;return{pageid:parseInt(d),file:p.title,url:`https://commons.wikimedia.org/wiki/${p.title}`,imageUrl(j){return ce(this.file,j)},coordinates:new v("Location",...l((O=p.coordinates)==null?void 0:O.find(j=>j.primary===""&&j.type==="camera"))),objectLocation:new v("Object location",...l((w=p.coordinates)==null?void 0:w.find(j=>j.type==="object")))}});function l(d){return typeof d=="object"?[d.lat,d.lon]:[void 0,void 0]}}async function ge(e){const a=[...e],o=[];for(;a.length;)o.push(a.splice(0,Math.min(W,a.length)));const u=o.map(g=>fe(g));return(await Promise.all(u)).flat()}async function je(e,a="categories|imageinfo|revisions|wbentityusage",o="url|extmetadata"){var A,C,S,E,I,r,f;const u={prop:a,pageids:e,iiprop:o,iiextmetadatafilter:"ImageDescription|Artist|DateTimeOriginal",iiextmetadatalanguage:document.body.parentElement.lang,...a.includes("categories")?{clshow:"!hidden"}:{},...a.includes("revisions")?{rvslots:"*",rvprop:"content"}:{}},l=await F(u),g=(C=(A=l==null?void 0:l.query)==null?void 0:A.pages)==null?void 0:C[e],d=((g==null?void 0:g.categories)||[]).map(t=>t.title.replace(/^Category:/,"")),p=(S=g==null?void 0:g.imageinfo[0])==null?void 0:S.extmetadata;return{categories:d,description:(E=p==null?void 0:p.ImageDescription)==null?void 0:E.value,author:(I=p==null?void 0:p.Artist)==null?void 0:I.value,timestamp:(r=p==null?void 0:p.DateTimeOriginal)==null?void 0:r.value,...o.includes("url")?{url:(f=g==null?void 0:g.imageinfo[0])==null?void 0:f.descriptionurl}:{},objectLocation:j(g),...O(g)};function O(t){var n,i,c,s,R;const m=(c=(i=(n=t==null?void 0:t.revisions)==null?void 0:n[0])==null?void 0:i.slots)==null?void 0:c.mediainfo["*"];if(!m)return{};const h=JSON.parse(m),b=w("Location",(s=h.statements[k.Location])==null?void 0:s[0]),y=w("Object location",(R=h.statements[k["Object location"]])==null?void 0:R[0]);return{...b?{coordinates:b}:{},...y?{objectLocation:y}:{}}}function w(t,m){var h;if(((h=m==null?void 0:m.mainsnak.datavalue)==null?void 0:h.type)==="globecoordinate")return new v(t,m==null?void 0:m.mainsnak.datavalue.value.latitude,m==null?void 0:m.mainsnak.datavalue.value.longitude)}function j(t){var m,h,b;try{const y=((b=(h=(m=t==null?void 0:t.revisions)==null?void 0:m[0])==null?void 0:h.slots)==null?void 0:b.main["*"])||"",n=y.match(/\{\{Object location( dec)?\|([0-9]+)\|([0-9]+)\|([0-9.]+)\|([NS])\|([0-9]+)\|([0-9]+)\|([0-9.]+)\|([WE])/i),i=y.match(/\{\{Object location( dec)?\s*\|\s*([0-9.]+)\s*\|\s*([0-9.]+)/i);let c,s;return n?(c=parseInt(n[2])+parseInt(n[3])/60+parseFloat(n[4])/3600,c*=n[5]==="N"?1:-1,s=parseInt(n[6])+parseInt(n[7])/60+parseFloat(n[8])/3600,s*=n[9]==="E"?1:-1):i&&(c=parseFloat(i[2]),s=parseFloat(i[3])),new v("Object location",c,s)}catch{return new v("Object location",void 0,void 0)}}}async function ve(e){return((await F({list:"allpages",apnamespace:ue,aplimit:30,apfrom:e,apprefix:e},{},void 0,()=>!1)).query.allpages||[]).map(u=>u.title.replace(/^Category:/,""))}async function Fe(e){return((await F({list:"allusers",aulimit:30,aufrom:e,apuprefix:e},{},void 0,()=>!1)).query.allusers||[]).map(u=>u.name)}async function Ce({files:e,user:a,userLimit:o,userStart:u,userEnd:l,category:g,categoryDepth:d}){if(typeof e=="string"&&(e=e.split("|")),e)return e.map(p=>p.startsWith("File:")?p:`File:${p}`);if(a)return o=typeof o=="string"?+o:o,de(a,o,u,l);if(g)return d=typeof d=="string"?+d:d,pe(g,d);throw new Error}function L(e,a){const o="https://commons.wikimedia.org/wiki/";return e.startsWith(o)&&(e=e.slice(o.length),e=decodeURI(e)),e.startsWith(a)&&(e=e.slice(a.length)),e}async function de(e,a,o,u){e=L(e,"User:");const l={generator:"allimages",gaiuser:e,gailimit:typeof a=="number"&&a<=500?a:"max",gaistart:u?new Date(u).toISOString():void 0,gaiend:o?new Date(o).toISOString():void 0,gaisort:"timestamp",gaidir:"older"},g=w=>Object.values(w.query.pages),p=await F(l,{},void 0,w=>w.continue?!a||g(w).length<a:!1),O=g(p).map(w=>w.title);return a?O.slice(0,a):O}async function pe(e,a=3){e=L(e,"Category:");const o=new AbortController,u=[he(e,a,o.signal),ye(e,a,o.signal),be(e,a,o.signal)];a<=0&&u.unshift(me(e,o.signal));try{return await we(u)}finally{o.abort()}}async function me(e,a){const o={list:"categorymembers",cmlimit:500,cmnamespace:x,cmtitle:"Category:"+e};return((await F(o,{},a)).query.categorymembers||[]).map(l=>l.title)}async function he(e,a,o){const u={lang:"commons",cat:e.replace(/^Category:/,""),type:x,depth:a,json:1},l="https://cats-php.toolforge.org/?"+T(u);return(await U(l,{signal:o})).map(d=>`File:${d}`)}async function ye(e,a,o){const u={category:e.replace(/^Category:/,""),ns:x,depth:a},l="/catscan?"+T(u);return(await U(l,{signal:o})).pages.map(d=>`File:${d}`)}async function be(e,a,o){const u={language:"commons",project:"wikimedia",depth:a,categories:e,[`ns[${x}]`]:1,format:"json",sparse:1,doit:1},l="https://petscan.wmcloud.org/?"+T(u);return(await U(l,{signal:o}))["*"][0].a["*"]}async function F(e,a={},o,u=l=>!!l.continue){const l={action:"query",format:"json",origin:"*",...e},g=le+"?"+T(l);let d=await U(g,{signal:o});return d=ae(a,d,{arrayMerge:(p,O)=>[].concat(...p,...O)}),u(d)?F({...e,continue:void 0,...d.continue},{...d,continue:void 0},o,u):d}function T(e){const a=new URLSearchParams;return Object.entries(e).forEach(([o,u])=>u===void 0||a.append(o,String(u))),a}function we(e){return e=e.filter(a=>!!a),new Promise((a,o)=>{e.forEach(u=>u.then(a)),Promise.allSettled(e).catch(o)})}async function U(e,a){console.log("Fetching",e);const o=await fetch(e,{cache:"no-cache",headers:{Accept:"application/json"},...a});if(o.ok)return o.json();throw new Error(o.statusText)}export{v as L,Fe as a,Ce as b,fe as c,je as d,Oe as e,G as f,ve as g};
//# sourceMappingURL=DadgABpvQcQp3i1OjiC.js.map
